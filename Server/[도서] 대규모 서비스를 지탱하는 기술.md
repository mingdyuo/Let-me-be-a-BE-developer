# 대규모 서비스를 지탱하는 기술

이토 나오야, 다나카 신지 공저 / 진명조 옮김 

## 1. 대규모 웹 서비스 개발 오리엔테이션 - 전체 그림 파악하기

<br>

### 0강. 이 책의 근간

#### 이 책에서 알아가는 것

- 대규모 서비스, 데이터를 다룰 경우를 대비한 기본적인 사고방식, 개념, 개요
- How-to 습득이 아닌 밑바탕이 되는 전체 그림을 파악

<br>

### 1강. 대규모 서비스와 소규모 서비스

#### 하테나의 서비스 규모

- 등록 사용자는 100만명 이상, 1,500만 UU(unique user)/월
- 수십 억 액세스/월
- 피크 시 회선 트래픽 양은 430Mbps
- 서버는 500대 이상

#### 소규모/대규모 서비스의 차이

1. 확장성 확보, 부하분산 필요

   액세스가 많으면 서버 1대로 처리 불가 -> 스케일 아웃 전략 사용

   하드웨어의 성능과 가격은 비례하지 않으므로 스케일 아웃이 비용 측면에서 좋다.

   하지만 스케일 아웃을 하면 새로운 문제가 발생한다. 

   - 사용자의 요청을 분배할 로드밸런서가 필요하다
   - 데이터 동기화가 필요하다

   - 네트워크 통신의 지연시간을 고려해야 한다. (통신의 오버헤드 존재)

2. 다중성 확보

   특정 서버에 문제가 생기더라도 계속 서비스를 제공할 수 있어야 한다. 이를 다중성을 지녔다고 한다.

   스케일 아웃을 하면 서버 대수가 늘어나고, 이는 서버의 고장률이 증가한다는 것을 의미한다.

   웹 서비스는 언제 어떤 경우든 고장에 대해 견고해야 한다. 

   > 야후는 미국의 테러 발생 시 다량의 검색으로 Top 페이지가 다운되었음. 이 때 CDN 서비스에 컨텐츠를 캐싱해서 트래픽을 우회해서 복구함

   시스템이 고장나면 그걸로 끝이어도 괜찮은 시스템 구축과, **고장 나더라도 다른 시스템이 자동적으로 처리를 인계받는 시스템** 구축 간에는 기술적/비용적 차이가 상당하다.

3. 효율적 운용 필요

   서버 대수가 100대를 넘으면 각 서버의 역할과 상황 파악이 힘들다. 

   이들을 효율적으로 운용하기 위해 자동화가 필요하다.

4. 개발자 수, 개발 방법의 변화

   서비스가 커지면 여러 기술자가 역할을 분담해서 일한다. 이 경우에도 개발 표준화와 관련된 새로운 문제가 발생한다.

   예를 들면 프로그래밍 언어, 라이브러리, 프레임워크, 코딩 규약, 버전관리 시스템의 사용 등이 있다.

   표준화의 틀을 정하는 것뿐만 아니라, 전체를 조정할 역할이 필요하다. 표준화 규칙이 지켜지고 있는지, 능력 차이에 발생하는 비효율 조정과 팀원 교육 등이 필요하다.

#### 하지만 가장 중요하게 다룰 것

데이터량이 커진다는 것을 가장 중요하게 다를 것이다.

- 컴퓨터가 처리를 수행하는 과정

  1. 디스크에서 데이터를 로드

  2. 메모리에 저장

  3. 저장된 메모리 데이터를 CPU가 fetch함

     이 과정에서 캐시 메모리에 캐싱

  4. CPU가 특정 처리를 수행

- 여기서 각 단계 사이에서는 속도차가 크게 발생한다.

  속도차에 대한 비효율을 줄이기 위해 데이터를 캐싱한다.DB 등의 미들웨어에서도 속도차를 줄이기 위해 데이터 구조와 구현을 맞추고 있다. 

- 하지만 한계가 있다. 데이터량이 많아지면 캐시미스 발생이 많아진다. 그러면 결국 디스크 I/O가 많아져 시스템 전체의 속도 저하를 일으킨다. 

  데이터가 적을 때에는 특별히 고민하지 않아도 모두 메모리에서 처리할 수 있다. 또한 간단한 알고리즘을 사용하는 것이 오버헤드가 적으므로 I/O 부하도 문제되지 않는다.

  하지만 서비스가 어느 정도 규모를 넘어서면 응급 처치로 문제가 해결되지 않는다.

- 그래서 대규모 서비스에서는

  1. 어떻게 하면 데이터를 적게 가져갈 수 있을까
  2. 여러 서버로 분산시킬 수 있을까
  3. 필요한 데이터를 최소한의 횟수로 읽어들일 수 있을까

  등등을 본질적으로 고민해야 한다.

<br>

### 2강. 계속 성장하는 서비스와 대규모화의 벽

<br>

<br>

<br>

<br>

## 2. 대규모 데이터 처리 입문 - 메모리와 디스크, 웹 애플리케이션과 부하

## 3. OS 캐시와 분산 - 대규모 데이터를 효율적으로 처리하는 원리

## 4. DB 스케일아웃 전략 - 분산을 고려한 MySQL 운용

## 5. 대규모 데이터 처리 실전 입문 - 애플리케이션 개발의 급소

## 6. [과제] 압축 프로그래밍 - 데이터 크기, I/O 고속화와의 관계 인식하기

## 7. 알고리즘 실용화 - 가까운 예로 보는 이론, 연구의 실전 투입

## 8. [과제] 하테나 키워드 링크 구현 - 응용으로 가는 길 깨닫기

## 9. 전문 검색기술 도전 - 대규모 데이터 처리의 노하우

## 10. [과제] 전문 검색엔진 작성 - 기초, 상세부분 작성, 속도와 정확성 추구

## 11. 대규모 데이터 처리를 지탱하는 서버/인프라 입문 - 웹서비스의 백엔드

## 12. 확장성 확보에 필요한 하고 방식 - 규모 증대와 시스템 확장

## 13. 다중성 확보, 시스템 안정화 - 100%에 근접한 가동률을 실현하는 원리

## 14. 효율향상 전략 - 하드웨어의 리소스 사용률 높이기

## 15. 웹 서비스와 네트워크 - 서비스의 성장

## Appendix A. 현대 웹 서비스 구축에 필요한 실전 기술 - 대규모 서비스에 대응하기 위해서
